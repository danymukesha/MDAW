<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MDAW">
<title>Introduction to MDAW • MDAW</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to MDAW">
<meta property="og:description" content="MDAW">
<meta property="og:image" content="https://danymukesha.github.io/MDAW/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MDAW</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Introduction.html">Introduction to MDAW</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danymukesha/MDAW/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to MDAW</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danymukesha/MDAW/blob/HEAD/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<p>In metabolomics studies, the accurate analysis and interpretation of
complex data sets is of utmost importance in order to obtain meaningful
biological insights. To address this issue, a robust computational
workflow for statistical analysis of both untargeted and targeted
metabolomics data is essential. Such a workflow not only ensures the
reliability of results, but also promotes reproducibility in data
analysis and reporting -
<code>a fundamental principle for scientific integrity</code> (Resnik
DB. et al., 2016).</p>
<p>In this context, the development of a comprehensive computational
framework is necessary, This framework should seamlessly integrate
various analysis steps, from data preprocessing to advanced statistical
modeling, while adhering to best practices in data processing and
interpretation. This allows the users to clearly and confidently
navigate the intricacies of metabolomics data, enabling in-depth
scientific investigation and knowledge expansion.</p>
<p>In this manuscript, a carefully designed computational workflow was
developed to the analysis of metabolomics data in binary classification
studies. The approach encompasses a range of techniques, including
<strong>univariate</strong> and <strong>multivariate</strong>
statistical analyses, <strong>quality control</strong> procedures, and
<strong>visualization</strong> tools, all aimed at deciphering the
complex metabolic signatures underlying biological phenomena. By
providing a structured framework and leveraging state-of-the-art methods
enhances the robustness of data analysis in metabolomics.</p>
<p>Here are the outlines for <code>MDAW</code>, a workflow for analyzing
metabolomics data, in a binary classification study. Let’s see together
the breakdown steps which consists this workflow:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Importing Data</strong>: Start by importing both
metabolite and experimental data from an Excel sheet. This step ensures
you have all needed information for the analysis.</p></li>
<li><p><strong>Pooled QC-based Data Cleaning</strong>: Quality control
(QC) is important in metabolomics to make sure that data obtained are
reliable. Pooled QC samples helps to identify and remove any technical
variation or artifacts in the data.</p></li>
<li><p><strong>Principal Component Analysis (PCA)
Visualization</strong>: PCA is a powerful tool for
<code>assessing data quality</code>, <code>identifying outliers</code>,
and
<code>gaining insights into the overall structure of the data</code>.
Visualizing the data using PCA plots help us to detect any clustering or
separation between sample groups.</p></li>
<li><p><strong>Two-Class Univariate Statistics</strong>: Perform
uni-variate statistical analysis to identify individual metabolites that
show significant differences between the two classes (e.g., control
vs. treatment). This analysis can involve statistical tests such as
<code>t-tests</code> or <code>ANOVA</code>, followed by correction for
multiple comparisons if needed.</p></li>
<li>
<p><strong>Multivariate Analysis with PLS-DA</strong>:</p>
<ul>
<li><p><strong>Model Optimization (R2 vs. Q2)</strong>: Optimize the
PLS-DA model by assessing the goodness of fit (R2) and predictive
ability (Q2) using cross-validation techniques.</p></li>
<li><p><strong>Permutation Testing</strong>: Validate the PLS-DA model
by permutation testing to assess its statistical significance and guard
against overfitting.</p></li>
<li><p><strong>Model Prediction Metrics</strong>: Evaluate the
performance of the PLS-DA model using metrics such as accuracy,
sensitivity, specificity, and area under the receiver operating
characteristic curve (AUC-ROC).</p></li>
<li><p><strong>Feature Importance</strong>: Identify important
metabolites contributing to the classification by examining variable
importance in projection (VIP) scores or loading plots.</p></li>
<li><p><strong>Model Prediction Data Visualizations</strong>: Visualize
the results of the PLS-DA model, such as score plots and class
prediction plots, to assess the separation between sample groups and the
model’s predictive ability.</p></li>
</ul>
</li>
<li><p><strong>Exporting Statistical Tables</strong>: Export relevant
statistical tables summarizing the results of univariate and
multivariate analyses to Excel sheets for further examination and
reporting.</p></li>
</ol>
<p>This workflow should provide a well streamlined computational
approach to analyzing metabolomics data in a binary classification
study, integrating both univariate and multivariate statistical methods
to identify biomarkers and gain insights into biological differences
between sample groups.</p>
<details><summary><strong>Session Info</strong>
</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/sessioninfo#readme" class="external-link">sessioninfo</a></span><span class="op">)</span></span>
<span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  C.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    C.UTF-8</span></span>
<span><span class="co">#&gt;  tz       UTC</span></span>
<span><span class="co">#&gt;  date     2024-03-03</span></span>
<span><span class="co">#&gt;  pandoc   3.1.11 @ /opt/hostedtoolcache/pandoc/3.1.11/x64/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package    </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version</span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  bslib         0.6.1   <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cachem        1.0.8   <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cli           3.6.2   <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  desc          1.4.3   <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  digest        0.6.34  <span style="color: #555555;">2024-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  evaluate      0.23    <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fastmap       1.1.1   <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fs            1.6.3   <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  glue          1.7.0   <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  htmltools     0.5.7   <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jquerylib     0.1.4   <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jsonlite      1.8.8   <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  knitr         1.45    <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  lifecycle     1.0.4   <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  magrittr      2.0.3   <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  memoise       2.0.1   <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgdown       2.0.7   <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">any (@2.0.7)</span></span></span>
<span><span class="co">#&gt;  purrr         1.0.2   <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  R6            2.5.1   <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ragg          1.2.7   <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rlang         1.1.3   <span style="color: #555555;">2024-01-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rmarkdown     2.25    <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sass          0.4.8   <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sessioninfo * 1.2.2   <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringi       1.8.3   <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringr       1.5.1   <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  systemfonts   1.0.5   <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  textshaping   0.3.7   <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  vctrs         0.6.5   <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xfun          0.42    <span style="color: #555555;">2024-02-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  yaml          2.3.8   <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /home/runner/work/_temp/Library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /opt/R/4.3.3/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [3] /opt/R/4.3.3/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
</details><div class="section level2">
<h2 id="libraries">Libraries<a class="anchor" aria-label="anchor" href="#libraries"></a>
</h2>
<p>Libraries(or Packages) provide functions that extend the basic
functionality of the R language. We will need the following tools to
analyse the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://danymukesha.github.io/MDAW/">MDAW</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-datapeak">Import data/peak<a class="anchor" aria-label="anchor" href="#import-datapeak"></a>
</h2>
<p>The chunk code below utilises a function called
<code><a href="../reference/import_dataXL.html">import_dataXL()</a></code> to import the Peak and Data sheets from an
Excel file. Once this is done, a notification appears to confirm that
the Peak and Data tables have been loaded from the corresponding
worksheets in the Excel file.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Theinput file (Excel spreadsheet)</span></span>
<span><span class="va">excel_file</span> <span class="op">&lt;-</span> <span class="st">"Gastric_NMR.xlsx"</span></span>
<span></span>
<span><span class="co"># The path to the input file (Excel spreadsheet)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Gastric_NMR.xlsx"</span>, package <span class="op">=</span> <span class="st">"MDAW"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The table of Data from an Excel file(data sheet)</span></span>
<span><span class="va">table_data</span> <span class="op">&lt;-</span> <span class="fu">MDAW</span><span class="fu">::</span><span class="fu"><a href="../reference/import_dataXL.html">import_dataXL</a></span><span class="op">(</span>xlsx_file_name <span class="op">=</span> <span class="va">path</span>, sheet_name <span class="op">=</span> <span class="st">"Data"</span>, </span>
<span>                                  interactive_output <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading sheet: Data </span></span>
<span><span class="co">#&gt; TOTAL ROWS: 140 </span></span>
<span><span class="co">#&gt; Done!</span></span>
<span></span>
<span><span class="co"># The table of Peak from an Excel file(peak sheet)</span></span>
<span><span class="va">table_peak</span> <span class="op">&lt;-</span> <span class="fu">MDAW</span><span class="fu">::</span><span class="fu"><a href="../reference/import_dataXL.html">import_dataXL</a></span><span class="op">(</span>xlsx_file_name <span class="op">=</span> <span class="va">path</span>, sheet_name <span class="op">=</span> <span class="st">"Peak"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading sheet: Peak </span></span>
<span><span class="co">#&gt; TOTAL ROWS: 149 </span></span>
<span><span class="co">#&gt; Done!</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-table-of-data">Load table of data<a class="anchor" aria-label="anchor" href="#load-table-of-data"></a>
</h2>
<p>The data table offers an interactive display feature, allowing to
easily inspect and verify the imported values. This functionality can be
accessed by utilizing the <code>reactable()</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_data</span>  <span class="co"># View and check the table data </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 140 × 154</span></span></span>
<span><span class="co">#&gt;    RowID   Idx SampleID  SampleType Class    M1      M2    M3    M4    M5    M6</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         1 sample_1  QC         QC     90.1   492.  203.   35   164.   19.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2         2 sample_2  Sample     GC     43     526.  130.   <span style="color: #BB0000;">NA</span>   694.  114. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3         3 sample_3  Sample     BN    214.  <span style="text-decoration: underline;">10</span>703.  105.   46.8 483.  152. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4         4 sample_4  Sample     HE     31.6    59.7  86.4  14    88.6  10.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5         5 sample_5  Sample     GC     81.9   259.  315.    8.7 243.   18.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6         6 sample_6  Sample     BN    197.    128.  862.   18.7 200.    4.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7         7 sample_7  Sample     GC     45.5   190.   32    <span style="color: #BB0000;">NA</span>   363.   35.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8         8 sample_8  Sample     HE     91     232.  212.   18.2  72.5   6.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9         9 sample_9  Sample     GC    481.    470.   60.7   8.4 270.   57.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10       10 sample_10 QC         QC     62.2   182.   75.5  36   203.   18.7</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 130 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 143 more variables: M7 &lt;dbl&gt;, M8 &lt;dbl&gt;, M9 &lt;dbl&gt;, M10 &lt;dbl&gt;, M11 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M12 &lt;dbl&gt;, M13 &lt;dbl&gt;, M14 &lt;dbl&gt;, M15 &lt;dbl&gt;, M16 &lt;dbl&gt;, M17 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M18 &lt;dbl&gt;, M19 &lt;dbl&gt;, M20 &lt;dbl&gt;, M21 &lt;dbl&gt;, M22 &lt;dbl&gt;, M23 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M24 &lt;dbl&gt;, M25 &lt;dbl&gt;, M26 &lt;dbl&gt;, M27 &lt;dbl&gt;, M28 &lt;dbl&gt;, M29 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M30 &lt;dbl&gt;, M31 &lt;dbl&gt;, M32 &lt;dbl&gt;, M33 &lt;dbl&gt;, M34 &lt;dbl&gt;, M35 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M36 &lt;dbl&gt;, M37 &lt;dbl&gt;, M38 &lt;dbl&gt;, M39 &lt;dbl&gt;, M40 &lt;dbl&gt;, M41 &lt;dbl&gt;, …</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-table-of-peaks">Load table of peaks<a class="anchor" aria-label="anchor" href="#load-table-of-peaks"></a>
</h2>
<p>The peak table offers an interactive display feature, allowing to
easily inspect and verify the imported values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_peak</span>  <span class="co"># View and check the table data </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 149 × 6</span></span></span>
<span><span class="co">#&gt;    RowID   Idx Name  Label                   Perc_missing QC_RSD</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         1 M1    1_3-Dimethylurate             11.4    32.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2         2 M2    1_6-Anhydro-β-D-glucose        0.714  31.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3         3 M3    1_7-Dimethylxanthine           5      35.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4         4 M4    1-Methylnicotinamide           8.57   12.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5         5 M5    2-Aminoadipate                 1.43    9.37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6         6 M6    2-Aminobutyrate                5      47.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7         7 M7    2-Furoylglycine                2.86    5.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8         8 M8    2-Hydroxyisobutyrate           0       5.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9         9 M9    2-Hydroxyphenylacetate        19.3    28.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10       10 M10   2-Oxoglutarate                 7.86   33.1 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 139 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-cleansing">Data Cleansing<a class="anchor" aria-label="anchor" href="#data-cleansing"></a>
</h2>
<p>Before beginning statistical or machine learning modeling, it is
important to assess the quality of your data and eliminate any
inaccurately measured metabolites. This process ensures the integrity of
your analytics. For this demonstration using the gastric cancer NMR data
set, basic statistical to measure each metabolite are already
calculated, which were then stored in the <code>table_peak.</code> In
this file, metabolites are stored in compliance with the following
conditions:</p>
<pre><code>- A QC-RSD (Relative Standard Deviation) below 20%.

- Fewer than 10% of values are absent.</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter clean metabolite from table_peak</span></span>
<span><span class="va">clean_table_peak</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">MDAW</span><span class="fu">::</span><span class="fu"><a href="../reference/clean_table_peak.html">clean_table_peak</a></span><span class="op">(</span>table <span class="op">=</span> <span class="va">table_peak</span>,</span>
<span>                         min_QC_RSD <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                         min_Perc_missing <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; 52 remaining peaks.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pca-principal-component-analysis">PCA (Principal Component Analysis)<a class="anchor" aria-label="anchor" href="#pca-principal-component-analysis"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_of_peaks</span> <span class="op">&lt;-</span> <span class="va">clean_table_peak</span><span class="op">[</span><span class="st">"Name"</span><span class="op">]</span></span>
<span><span class="va">table_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">RowID</span>, </span>
<span>                  <span class="va">Idx</span>, </span>
<span>                  <span class="va">SampleID</span>, </span>
<span>                  <span class="va">SampleType</span>, </span>
<span>                  <span class="va">Class</span>,</span>
<span>                  <span class="va">list_of_peaks</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 140 × 57</span></span></span>
<span><span class="co">#&gt;    RowID   Idx SampleID  SampleType Class    M4    M5    M7    M8    M11   M14</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         1 sample_1  QC         QC     35   164.   41    46.5   61.7  35.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2         2 sample_2  Sample     GC     <span style="color: #BB0000;">NA</span>   694.   37.9 126.   491.   <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3         3 sample_3  Sample     BN     46.8 483.  110.   85.1 <span style="text-decoration: underline;">2</span>441.   29.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4         4 sample_4  Sample     HE     14    88.6 170.   23.9  141.   62.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5         5 sample_5  Sample     GC      8.7 243.  349.   61.1   48.7  77.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6         6 sample_6  Sample     BN     18.7 200.   37.3 244.   104.   52.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7         7 sample_7  Sample     GC     <span style="color: #BB0000;">NA</span>   363.   59.6  51.3   58.1  34.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8         8 sample_8  Sample     HE     18.2  72.5  15.3  37.1   54.1  30.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9         9 sample_9  Sample     GC      8.4 270.  214.   65.6   92.9  61.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10       10 sample_10 QC         QC     36   203.   44.4  48.6   59    28.4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 130 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more variables: M15 &lt;dbl&gt;, M25 &lt;dbl&gt;, M26 &lt;dbl&gt;, M31 &lt;dbl&gt;, M32 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M33 &lt;dbl&gt;, M36 &lt;dbl&gt;, M37 &lt;dbl&gt;, M45 &lt;dbl&gt;, M48 &lt;dbl&gt;, M50 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M51 &lt;dbl&gt;, M65 &lt;dbl&gt;, M66 &lt;dbl&gt;, M68 &lt;dbl&gt;, M71 &lt;dbl&gt;, M73 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M74 &lt;dbl&gt;, M75 &lt;dbl&gt;, M88 &lt;dbl&gt;, M89 &lt;dbl&gt;, M90 &lt;dbl&gt;, M91 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M93 &lt;dbl&gt;, M101 &lt;dbl&gt;, M104 &lt;dbl&gt;, M105 &lt;dbl&gt;, M106 &lt;dbl&gt;, M107 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M110 &lt;dbl&gt;, M115 &lt;dbl&gt;, M116 &lt;dbl&gt;, M118 &lt;dbl&gt;, M119 &lt;dbl&gt;, M120 &lt;dbl&gt;, …</span></span></span>
<span></span>
<span><span class="va">matrix_data</span> <span class="op">&lt;-</span> <span class="va">table_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">list_of_peaks</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 140 × 52</span></span></span>
<span><span class="co">#&gt;        M4    M5    M7    M8   M11   M14   M15   M25   M26    M31   M32   M33</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  1.54   2.22  1.61  1.67  1.79  1.55  1.46 1.33   1.22  1.28   1.99  2.44</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #BB0000;">NA</span>      2.84  1.58  2.10  2.69 <span style="color: #BB0000;">NA</span>     2.32 1.45   1.68  3.13   2.79  2.89</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  1.67   2.68  2.04  1.93  3.39  1.47  1.66 1.55   1.43 -<span style="color: #BB0000;">0.699</span>  2.56  2.73</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  1.15   1.95  2.23  1.38  2.15  1.80  1.58 1.42   1.01  0.681  2.05  2.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  0.940  2.39  2.54  1.79  1.69  1.89  1.71 1.77   1.82  1.05   2.37  2.52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  1.27   2.30  1.57  2.39  2.02  1.72  1.89 1.46   1.31  2.05   1.88  2.47</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #BB0000;">NA</span>      2.56  1.78  1.71  1.76  1.54  1.76 1.76   1.73  1.42   2.09  2.43</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  1.26   1.86  1.18  1.57  1.73  1.48  1.28 0.820  1.47  0.996  1.59  2.40</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  0.924  2.43  2.33  1.82  1.97  1.79  1.73 1.60   1.32  1.83   2.65  2.51</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  1.56   2.31  1.65  1.69  1.77  1.45  1.47 1.42   1.19  1.31   1.98  2.53</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 130 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 40 more variables: M36 &lt;dbl&gt;, M37 &lt;dbl&gt;, M45 &lt;dbl&gt;, M48 &lt;dbl&gt;, M50 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M51 &lt;dbl&gt;, M65 &lt;dbl&gt;, M66 &lt;dbl&gt;, M68 &lt;dbl&gt;, M71 &lt;dbl&gt;, M73 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M74 &lt;dbl&gt;, M75 &lt;dbl&gt;, M88 &lt;dbl&gt;, M89 &lt;dbl&gt;, M90 &lt;dbl&gt;, M91 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M93 &lt;dbl&gt;, M101 &lt;dbl&gt;, M104 &lt;dbl&gt;, M105 &lt;dbl&gt;, M106 &lt;dbl&gt;, M107 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M110 &lt;dbl&gt;, M115 &lt;dbl&gt;, M116 &lt;dbl&gt;, M118 &lt;dbl&gt;, M119 &lt;dbl&gt;, M120 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   M122 &lt;dbl&gt;, M126 &lt;dbl&gt;, M129 &lt;dbl&gt;, M130 &lt;dbl&gt;, M134 &lt;dbl&gt;, M137 &lt;dbl&gt;, …</span></span></span>
<span></span>
<span><span class="co"># missing value imputation (knn - 3 nearest neighbors)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://danymukesha.github.io/" class="external-link">Dany Mukesha</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
